<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR.IO Bundler - Admin Dashboard</title>
  <link rel="stylesheet" href="dashboard.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-left">
      <h1>üöÄ AR.IO Bundler Admin</h1>
    </div>
    <div class="nav-center">
      <a href="/admin/dashboard" class="nav-link active">Dashboard</a>
      <a href="/admin/queues" class="nav-link">Queues</a>
    </div>
    <div class="nav-right">
      <button id="refresh-btn" class="refresh-btn" onclick="fetchStats()">
        <span id="refresh-icon">üîÑ</span> Refresh
      </button>
      <div class="refresh-indicator">
        <span class="status-dot" id="status-dot"></span>
        <span id="last-refresh">Never</span>
      </div>
    </div>
  </nav>

  <div class="container">
    <!-- Loading State -->
    <div id="loading" class="loading">
      <div class="spinner"></div>
      <p>Loading dashboard data...</p>
    </div>

    <!-- Error State -->
    <div id="error" class="error-banner" style="display: none;">
      <strong>‚ö†Ô∏è Error:</strong> <span id="error-message"></span>
      <button onclick="fetchStats()">Retry</button>
    </div>

    <!-- Dashboard Content -->
    <div id="dashboard" style="display: none;">

      <!-- System Health Section -->
      <section class="section">
        <h2>System Health</h2>
        <div id="health-grid" class="health-grid">
          <!-- Populated by JS -->
        </div>
      </section>

      <!-- Stats Overview Cards -->
      <section class="section">
        <h2>Overview</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">üì§</div>
            <div class="stat-content">
              <div class="stat-label">Today's Uploads</div>
              <div class="stat-value" id="today-uploads">--</div>
              <div class="stat-meta" id="today-bytes">--</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">üì¶</div>
            <div class="stat-content">
              <div class="stat-label">All Time Uploads</div>
              <div class="stat-value" id="total-uploads">--</div>
              <div class="stat-meta" id="total-bytes">--</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">üë•</div>
            <div class="stat-content">
              <div class="stat-label">Unique Users</div>
              <div class="stat-value" id="unique-users">--</div>
              <div class="stat-meta" id="users-today">--</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">üí≥</div>
            <div class="stat-content">
              <div class="stat-label">Traditional Payments</div>
              <div class="stat-value" id="traditional-total">--</div>
              <div class="stat-meta" id="traditional-count">--</div>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">üí∞</div>
            <div class="stat-content">
              <div class="stat-label">x402 Payments (USDC)</div>
              <div class="stat-value" id="x402-total">--</div>
              <div class="stat-meta" id="x402-count">--</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Charts Row -->
      <div class="charts-row">
        <!-- Signature Type Distribution -->
        <section class="section chart-section">
          <h2>Uploads by Signature Type</h2>
          <div class="chart-container">
            <canvas id="signature-chart"></canvas>
          </div>
        </section>

        <!-- Traditional Payment Types Distribution -->
        <section class="section chart-section">
          <h2>Traditional Payment Types</h2>
          <div class="chart-container">
            <canvas id="payment-type-chart"></canvas>
          </div>
        </section>
      </div>

      <!-- Networks Chart -->
      <section class="section">
        <h2>x402 Payments by Network</h2>
        <div class="chart-container-wide">
          <canvas id="network-chart"></canvas>
        </div>
      </section>

      <!-- Queue Health -->
      <section class="section">
        <h2>Queue Status</h2>
        <div class="queue-summary" id="queue-summary">
          <!-- Populated by JS -->
        </div>
        <div class="queue-grid" id="queue-grid">
          <!-- Populated by JS -->
        </div>
      </section>

      <!-- Top Uploaders -->
      <section class="section">
        <h2>Top Uploaders (Last 30 Days)</h2>
        <div class="table-container">
          <table id="top-uploaders-table">
            <!-- Populated by JS -->
          </table>
        </div>
      </section>

      <!-- Recent Activity -->
      <section class="section">
        <h2>Recent Uploads</h2>
        <div class="table-container">
          <table id="recent-uploads-table">
            <!-- Populated by JS -->
          </table>
        </div>
      </section>

      <!-- Recent Traditional Payments -->
      <section class="section">
        <h2>Recent Traditional Payments</h2>
        <div class="table-container">
          <table id="recent-traditional-payments-table">
            <!-- Populated by JS -->
          </table>
        </div>
      </section>

      <!-- Recent x402 Payments -->
      <section class="section">
        <h2>Recent x402 Payments (USDC)</h2>
        <div class="table-container">
          <table id="recent-x402-payments-table">
            <!-- Populated by JS -->
          </table>
        </div>
      </section>

    </div>
  </div>

  <script src="dashboard.js"></script>
</body>
</html>
